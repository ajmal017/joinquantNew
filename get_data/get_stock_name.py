# -*- coding: utf-8 -*-
'''
@Time    : 2020/9/18 16:52
@Author  : zhangfang
@File    : get_stock_name.py
'''
from __future__ import division
from jqdatasdk import finance
import jqdatasdk

import pandas as pd
import datetime
from trading_future.future_singleton import Future
from jqdatasdk import *
from configDB import *
auth(JOINQUANT_USER, JOINQUANT_PW)

if __name__ == "__main__":
    remove_st_data = {'600265.SH': ['2010-01-01', '', '被st了的股票', 1], '600807.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '603996.SH': ['2010-01-01', '', '被st了的股票', 1], '600680.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600243.SH': ['2010-01-01', '', '被st了的股票', 1], '600225.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600091.SH': ['2010-01-01', '', '被st了的股票', 1], '600119.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '900951.SH': ['2010-01-01', '', '被st了的股票', 1], '900946.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '900937.SH': ['2010-01-01', '', '被st了的股票', 1], '900907.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '603779.SH': ['2010-01-01', '', '被st了的股票', 1], '603188.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '601798.SH': ['2010-01-01', '', '被st了的股票', 1], '601268.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '601258.SH': ['2010-01-01', '', '被st了的股票', 1], '601113.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600877.SH': ['2010-01-01', '', '被st了的股票', 1], '600870.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600860.SH': ['2010-01-01', '', '被st了的股票', 1], '600856.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600817.SH': ['2010-01-01', '', '被st了的股票', 1], '600781.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600767.SH': ['2010-01-01', '', '被st了的股票', 1], '600726.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600725.SH': ['2010-01-01', '', '被st了的股票', 1], '600721.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600701.SH': ['2010-01-01', '', '被st了的股票', 1], '600698.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600696.SH': ['2010-01-01', '', '被st了的股票', 1], '600687.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600677.SH': ['2010-01-01', '', '被st了的股票', 1], '600666.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600652.SH': ['2010-01-01', '', '被st了的股票', 1], '600634.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600614.SH': ['2010-01-01', '', '被st了的股票', 1], '600610.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600608.SH': ['2010-01-01', '', '被st了的股票', 1], '600595.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600539.SH': ['2010-01-01', '', '被st了的股票', 1], '600518.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600462.SH': ['2010-01-01', '', '被st了的股票', 1], '600423.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600421.SH': ['2010-01-01', '', '被st了的股票', 1], '600416.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600408.SH': ['2010-01-01', '', '被st了的股票', 1], '600399.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600385.SH': ['2010-01-01', '', '被st了的股票', 1], '600354.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600319.SH': ['2010-01-01', '', '被st了的股票', 1], '600301.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600290.SH': ['2010-01-01', '', '被st了的股票', 1], '600289.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600275.SH': ['2010-01-01', '', '被st了的股票', 1], '600247.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600238.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600234.SH': ['2010-01-01', '2021-01-01', '被st了的股票', 1],
                      '600228.SH': ['2010-01-01', '', '被st了的股票', 1], '600209.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600193.SH': ['2010-01-01', '', '被st了的股票', 1], '600179.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600149.SH': ['2010-01-01', '', '被st了的股票', 1], '600112.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600084.SH': ['2010-01-01', '', '被st了的股票', 1], '600815.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600654.SH': ['2010-01-01', '', '被st了的股票', 1], '600485.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '900930.SH': ['2010-01-01', '', '被st了的股票', 1], '900906.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '600891.SH': ['2010-01-01', '', '被st了的股票', 1], '600145.SH': ['2010-01-01', '', '被st了的股票', 1],
                      '601558.SH': ['2010-01-01', '', '被st了的股票', 1], '000911.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '000816.SZ': ['2010-01-01', '', '被st了的股票', 1], '000897.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '000837.SZ': ['2010-01-01', '', '被st了的股票', 1], '002766.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002569.SZ': ['2010-01-01', '', '被st了的股票', 1], '002420.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002336.SZ': ['2010-01-01', '', '被st了的股票', 1], '002190.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002072.SZ': ['2010-01-01', '', '被st了的股票', 1], '000995.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '000820.SZ': ['2010-01-01', '', '被st了的股票', 1], '000792.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002684.SZ': ['2010-01-01', '', '被st了的股票', 1], '200168.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002872.SZ': ['2010-01-01', '', '被st了的股票', 1], '002716.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002711.SZ': ['2010-01-01', '', '被st了的股票', 1], '002692.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002656.SZ': ['2010-01-01', '', '被st了的股票', 1], '002642.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002629.SZ': ['2010-01-01', '', '被st了的股票', 1], '002586.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002575.SZ': ['2010-01-01', '', '被st了的股票', 1], '002501.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002499.SZ': ['2010-01-01', '', '被st了的股票', 1], '002445.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002427.SZ': ['2010-01-01', '', '被st了的股票', 1], '002359.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002356.SZ': ['2010-01-01', '', '被st了的股票', 1], '002333.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002323.SZ': ['2010-01-01', '', '被st了的股票', 1], '002306.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002289.SZ': ['2010-01-01', '', '被st了的股票', 1], '002263.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002259.SZ': ['2010-01-01', '', '被st了的股票', 1], '002220.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002210.SZ': ['2010-01-01', '', '被st了的股票', 1], '002200.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002192.SZ': ['2010-01-01', '', '被st了的股票', 1], '002188.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002175.SZ': ['2010-01-01', '', '被st了的股票', 1], '002147.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002122.SZ': ['2010-01-01', '', '被st了的股票', 1], '002113.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002089.SZ': ['2010-01-01', '', '被st了的股票', 1], '002086.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002021.SZ': ['2010-01-01', '', '被st了的股票', 1], '002005.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '000982.SZ': ['2010-01-01', '', '被st了的股票', 1], '000972.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '000953.SZ': ['2010-01-01', '', '被st了的股票', 1], '000927.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '000868.SZ': ['2010-01-01', '', '被st了的股票', 1], '000806.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '000760.SZ': ['2010-01-01', '', '被st了的股票', 1], '000752.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '000737.SZ': ['2010-01-01', '', '被st了的股票', 1], '000727.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '000707.SZ': ['2010-01-01', '', '被st了的股票', 1], '000611.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '000585.SZ': ['2010-01-01', '', '被st了的股票', 1], '000571.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '000509.SZ': ['2010-01-01', '', '被st了的股票', 1], '000504.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '000422.SZ': ['2010-01-01', '', '被st了的股票', 1], '000410.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '000409.SZ': ['2010-01-01', '', '被st了的股票', 1], '000010.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002290.SZ': ['2010-01-01', '', '被st了的股票', 1], '002207.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002102.SZ': ['2010-01-01', '', '被st了的股票', 1], '000971.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '000572.SZ': ['2010-01-01', '', '被st了的股票', 1], '000939.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '000981.SZ': ['2010-01-01', '', '被st了的股票', 1], '002604.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002450.SZ': ['2010-01-01', '', '被st了的股票', 1], '000670.SZ': ['2010-01-01', '', '被st了的股票', 1],
                      '002260.SZ': ['2010-01-01', '', '被st了的股票', 1], '000787.SZ': ['2010-01-01', '', '被st了的股票', 1]}
    lst = []
    n=0
    for x, y in remove_st_data.items():
        print(x)
        code = jqdatasdk.normalize_code(x)
        n+=1
        # print()

        # finance.run_query(query(finance.STK_NAME_HISTORY).filter(finance.STK_NAME_HISTORY.code == code))

        q = query(finance.STK_STATUS_CHANGE).filter(finance.STK_STATUS_CHANGE.code == code)
        df = finance.run_query(q)
        lst.append(df)
    ret = pd.concat(lst)
    print(ret)
    print(n)
    ret.to_excel('c://e/data/change.xlsx', encoding='gbk')
